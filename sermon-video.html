<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AMI êµíšŒ</title>
    <link rel="stylesheet" href="assets/css/common.css">
    <link rel="stylesheet" href="assets/css/church.css">
    <link rel="stylesheet" href="assets/css/korean-worship.css">
</head>
<body>
    <header>
        <a href="index.html" class="logo">
            <img src="assets/images/logo1.png" alt="AMI êµíšŒ ë¡œê³ ">
        </a>
        <nav>
            <a href="ami-church.html">AMI êµíšŒ</a>
            <a href="#mission">ì„ êµ ì„¼í„°</a>
            <a href="sermon-video.html">ì„¤êµ ì˜ìƒ</a>
            <a href="#international">International</a>
        </nav>
        <div class="search-icon">
            <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                <circle cx="14" cy="14" r="9" stroke="#fff" stroke-width="2"/>
                <path d="M21 21L27 27" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
            </svg>
        </div>
    </header>

    <section class="hero-sermon">
        <h1>ì„¤êµ ì˜ìƒ</h1>
    </section>

    <div class="content">
        <div class="content-wrapper">
            <nav class="lnb">
                <ul>
                    <li><a href="#koreanworship" data-page="koreanworship" data-file="pages/korean-worship.html" class="active">í•œêµ­ ì˜ˆë°°</a></li>
                    <li><a href="#aba" data-page="aba" data-file="pages/aba.html">ABA</a></li>
                    <li><a href="#avs" data-page="avs" data-file="pages/avs.html">AVS</a></li>
                    <li><a href="#avck" data-page="avck" data-file="pages/avck.html">AVCK</a></li>
                </ul>
            </nav>
            
            <div class="content-area" id="contentArea">
                <div class="loading">ì»¨í…ì¸ ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
            </div>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <div>
                <div class="footer-logo">
                    <img src="assets/images/logo_footer.png" alt="AMI êµíšŒ ë¡œê³ ">
                </div>
                <div class="footer-info">
                    <p>Tel : 82-31-265-1455, 82-31-263-7450</p>
                    <p>Fax : 82-31-266-7450</p>
                    <p>187, Dongchun-Dong, Suji-Gu, Yongin-City, Kyunggi-Do, Korea</p>
                    <p style="margin-top:20px;">Â© Copyrights 2025 AMI Missions International. All rights reserved.</p>
                </div>
            </div>
            
            <div class="footer-nav">
                <div class="footer-section">
                    <h3><a href="#greeting" data-page="greeting" data-file="pages/greeting.html">AMI êµíšŒ</a></h3>
                    <ul>
                        <li><a href="#greeting" data-page="greeting" data-file="pages/greeting.html">ì¸ì‚¬ë§</a></li>
                        <li><a href="#intro" data-page="intro" data-file="pages/intro.html">êµíšŒ ì†Œê°œ</a></li>
                        <li><a href="#schedule" data-page="schedule" data-file="pages/schedule.html">ì˜ˆë°° ì‹œê°„</a></li>
                        <li><a href="#location" data-page="location" data-file="pages/location.html">ì˜¤ì‹œëŠ” ê¸¸</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3><a href="#">ì„ êµ ì„¼í„°</a></h3>
                    <ul>
                        <li><a href="#">ì„¼í„° ì†Œê°œ</a></li>
                        <li><a href="#">ì„¬ê¸°ëŠ” ì‚¬ëŒë“¤</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3><a href="#">ì„¤êµ ì˜ìƒ</a></h3>
                    <ul>
                        <li><a href="#koreanworship" data-page="koreanworship" data-file="pages/korean-worship.html" class="active">í•œêµ­ ì˜ˆë°°</a></li>
                        <li><a href="#aba" data-page="aba" data-file="pages/aba.html">ABA</a></li>
                        <li><a href="#avs" data-page="avs" data-file="pages/avs.html">AVS</a></li>
                        <li><a href="#avck" data-page="avck" data-file="pages/avck.html">AVCK</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3><a href="#">International</a></h3>
                </div>
            </div>
            
            <div class="scroll-top" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <path d="M12 20V4M12 4L6 10M12 4L18 10" stroke="#000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>
        </div>
    </footer>

    <script>
        /* ========================================
           1. í˜ì´ì§€ ì„¤ì • - ê° ë©”ë‰´ì™€ HTML íŒŒì¼ ë§¤í•‘
           ======================================== */
        // í˜ì´ì§€ ì´ë¦„(í‚¤)ê³¼ ì‹¤ì œ HTML íŒŒì¼ëª…(ê°’)ì„ ì—°ê²°í•˜ëŠ” ê°ì²´
        // ì˜ˆ: 'greeting' ë©”ë‰´ í´ë¦­ ì‹œ â†’ 'greeting.html' íŒŒì¼ ë¡œë“œ
        const pageFiles = {
            koreanworship: 'pages/korean-worship.html',    // ì¸ì‚¬ë§ í˜ì´ì§€
            aba: 'pages/aba.html',          // êµíšŒ ì†Œê°œ í˜ì´ì§€
            avs: 'pages/avs.html',    // ì˜ˆë°° ì‹œê°„ í˜ì´ì§€
            avck: 'pages/avck.html'     // ì˜¤ì‹œëŠ” ê¸¸ í˜ì´ì§€
        };

        /* ========================================
           2. ì™¸ë¶€ HTML íŒŒì¼ ë¡œë“œ í•¨ìˆ˜
           ======================================== */
        /**
         * ì™¸ë¶€ HTML íŒŒì¼ì˜ ì „ì²´ ë‚´ìš©ì„ ê·¸ëŒ€ë¡œ ê°€ì ¸ì˜¤ëŠ” ë¹„ë™ê¸° í•¨ìˆ˜
         * @param {string} filename - ë¡œë“œí•  HTML íŒŒì¼ëª… (ì˜ˆ: 'greeting.html')
         * @returns {Promise<string>} - HTML ì»¨í…ì¸  ë¬¸ìì—´
         */
        async function loadContentFromFile(filename) {
            try {
                // STEP 1: Fetch APIë¥¼ ì‚¬ìš©í•˜ì—¬ ì™¸ë¶€ HTML íŒŒì¼ ìš”ì²­
                // await: íŒŒì¼ ë‹¤ìš´ë¡œë“œê°€ ì™„ë£Œë  ë•Œê¹Œì§€ ëŒ€ê¸°
                const response = await fetch(filename);
                
                // STEP 2: HTTP ì‘ë‹µ ìƒíƒœ í™•ì¸ (404, 500 ë“±ì˜ ì—ëŸ¬ ì²´í¬)
                if (!response.ok) {
                    throw new Error(`íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ${filename}`);
                }
                
                // STEP 3: ì‘ë‹µ ë³¸ë¬¸ì„ í…ìŠ¤íŠ¸(HTML ë¬¸ìì—´)ë¡œ ë³€í™˜í•˜ê³  ê·¸ëŒ€ë¡œ ë°˜í™˜
                // íŒŒì¼ì—ëŠ” ìˆœìˆ˜ ì»¨í…ì¸ ë§Œ ìˆìœ¼ë¯€ë¡œ íŒŒì‹± ì—†ì´ ê·¸ëŒ€ë¡œ ì‚¬ìš©
                const html = await response.text();
                return html;
                
            } catch (error) {
                // STEP 4: ì—ëŸ¬ ë°œìƒ ì‹œ ì½˜ì†”ì— ë¡œê·¸ ì¶œë ¥ ë° ì—ëŸ¬ ë©”ì‹œì§€ HTML ë°˜í™˜
                console.error('Error loading content:', error);
                return `
                    <div class="error-message">
                        <h3>ì»¨í…ì¸ ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</h3>
                        <p>${error.message}</p>
                        <p>ë¡œì»¬ ì„œë²„ í™˜ê²½ì—ì„œ ì‹¤í–‰í•´ì£¼ì„¸ìš”. (ì˜ˆ: Live Server, Python HTTP Server ë“±)</p>
                    </div>
                `;
            }
        }

        /* ========================================
           3. ì»¨í…ì¸  ë¡œë“œ ë° í™”ë©´ ì „í™˜ í•¨ìˆ˜
           ======================================== */
        /**
         * ì§€ì •ëœ í˜ì´ì§€ì˜ ì»¨í…ì¸ ë¥¼ ë¡œë“œí•˜ê³  í™”ë©´ì— í‘œì‹œí•˜ëŠ” ë¹„ë™ê¸° í•¨ìˆ˜
         * @param {string} page - ë¡œë“œí•  í˜ì´ì§€ ì´ë¦„ (ì˜ˆ: 'greeting', 'intro')
         * @param {boolean} shouldScroll - ìŠ¤í¬ë¡¤ ì—¬ë¶€ (ê¸°ë³¸ê°’: true, ì´ˆê¸° ë¡œë“œ ì‹œ false)
         */
        async function loadContent(page, shouldScroll = true) {
            // STEP 1: ì»¨í…ì¸ ë¥¼ í‘œì‹œí•  DOM ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
            const contentArea = document.getElementById('contentArea');
            // STEP 2: pageFiles ê°ì²´ì—ì„œ í˜ì´ì§€ ì´ë¦„ì— í•´ë‹¹í•˜ëŠ” íŒŒì¼ëª… ì°¾ê¸°
            const filename = pageFiles[page];
            
            // STEP 3: ìœ íš¨í•˜ì§€ ì•Šì€ í˜ì´ì§€ ì´ë¦„ì¸ ê²½ìš° ì—ëŸ¬ ë©”ì‹œì§€ í‘œì‹œ
            if (!filename) {
                contentArea.innerHTML = '<p>í˜ì´ì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            // STEP 4: í˜ì´ë“œ ì•„ì›ƒ íš¨ê³¼ ì‹œì‘
            // 'fade-out' í´ë˜ìŠ¤ ì¶”ê°€ â†’ CSS transitionìœ¼ë¡œ opacity: 1 â†’ 0
            contentArea.classList.add('fade-out');
            
            // STEP 5: 300ms í›„ì— ì‹¤í–‰ (í˜ì´ë“œ ì•„ì›ƒ ì• ë‹ˆë©”ì´ì…˜ ì™„ë£Œ ëŒ€ê¸°)
            setTimeout(async () => {
                // STEP 6: ë¡œë”© ì¤‘ ë©”ì‹œì§€ í‘œì‹œ
                contentArea.innerHTML = '<div class="loading">ì»¨í…ì¸ ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>';
                
                // STEP 7: ì™¸ë¶€ íŒŒì¼ì—ì„œ ì»¨í…ì¸  ë¡œë“œ (ë¹„ë™ê¸°)
                const content = await loadContentFromFile(filename);
                
                // STEP 8: ë¡œë“œëœ ì»¨í…ì¸ ë¥¼ DOMì— ì‚½ì…
                // innerHTML: ê¸°ì¡´ ë‚´ìš©ì„ ì™„ì „íˆ ìƒˆë¡œìš´ HTMLë¡œ êµì²´
                contentArea.innerHTML = content;

                if (page === 'koreanworship') {
                    console.log('ğŸ”„ korean-worship ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ì‹œì‘...');
                    
                    const existingScript = document.querySelector('script[src="assets/js/korean-worship.js"]');
                    if (existingScript) {
                        existingScript.remove();
                    }
                    
                    const script = document.createElement('script');
                    script.type = 'module';
                    script.src = 'assets/js/korean-worship.js';
                    script.onload = async () => {
                        console.log('âœ… korean-worship.js ë¡œë“œ ì™„ë£Œ');
                        const module = await import('./assets/js/korean-worship.js');
                        await module.initKoreanWorship();
                    };
                    script.onerror = (error) => {
                        console.error('âŒ korean-worship.js ë¡œë“œ ì‹¤íŒ¨:', error);
                    };
                    document.body.appendChild(script);
                }

                // STEP 8-1: intro í˜ì´ì§€ì¸ ê²½ìš° íƒ€ì„ë¼ì¸ ì´ˆê¸°í™”
                if (page === 'intro') {
                    initTimeline();
                }
                
                // STEP 9: í˜ì´ë“œ ì¸ íš¨ê³¼ (fade-out í´ë˜ìŠ¤ ì œê±°)
                // í´ë˜ìŠ¤ ì œê±° â†’ CSS transitionìœ¼ë¡œ opacity: 0 â†’ 1
                contentArea.classList.remove('fade-out');
                
                // STEP 10: ë©”ë‰´ í´ë¦­ ì‹œì—ë§Œ ì»¨í…ì¸  ì˜ì—­ìœ¼ë¡œ ìŠ¤í¬ë¡¤ (ì´ˆê¸° ë¡œë“œ ì‹œì—ëŠ” ìŠ¤í¬ë¡¤ ì•ˆ í•¨)
                if (shouldScroll) {
                    const contentSection = document.querySelector('.content');
                    if (contentSection) {
                        contentSection.scrollIntoView({ 
                            behavior: 'smooth',  // ë¶€ë“œëŸ¬ìš´ ìŠ¤í¬ë¡¤
                            block: 'start'       // ìš”ì†Œì˜ ìƒë‹¨ì´ ë³´ì´ë„ë¡
                        });
                    }
                }
            }, 300);  // í˜ì´ë“œ ì•„ì›ƒ ì• ë‹ˆë©”ì´ì…˜ ì‹œê°„ê³¼ ë™ì¼
        }

        /* ========================================
           4. ë©”ë‰´ í™œì„±í™” ìƒíƒœ ê´€ë¦¬ í•¨ìˆ˜
           ======================================== */
        /**
         * í˜„ì¬ ì„ íƒëœ ë©”ë‰´ë¥¼ ì‹œê°ì ìœ¼ë¡œ í•˜ì´ë¼ì´íŠ¸ í‘œì‹œ
         * @param {string} page - í™œì„±í™”í•  í˜ì´ì§€ ì´ë¦„
         */
        function setActiveMenu(page) {
            // STEP 1: LNBì™€ í‘¸í„°ì˜ ëª¨ë“  ë©”ë‰´ ë§í¬ì—ì„œ 'active' í´ë˜ìŠ¤ ì œê±°
            // querySelectorAll: ì¡°ê±´ì— ë§ëŠ” ëª¨ë“  ìš”ì†Œë¥¼ NodeListë¡œ ë°˜í™˜
            // forEach: ê° ìš”ì†Œì— ëŒ€í•´ ë°˜ë³µ ì‘ì—… ìˆ˜í–‰
            document.querySelectorAll('.lnb a, .footer-section a').forEach(link => {
                link.classList.remove('active');
            });
            
            // STEP 2: í˜„ì¬ í˜ì´ì§€ì™€ ì¼ì¹˜í•˜ëŠ” data-page ì†ì„±ì„ ê°€ì§„ ëª¨ë“  ë§í¬ì— 'active' í´ë˜ìŠ¤ ì¶”ê°€
            // í…œí”Œë¦¿ ë¦¬í„°ëŸ´ë¡œ ë™ì  ì„ íƒì ìƒì„±: [data-page="greeting"]
            // LNBì™€ í‘¸í„°ì— ìˆëŠ” ê°™ì€ ë©”ë‰´ê°€ ëª¨ë‘ í™œì„±í™”ë¨
            document.querySelectorAll(`[data-page="${page}"]`).forEach(link => {
                link.classList.add('active');  // íŒŒë€ìƒ‰ ë°°ê²½ + í°ìƒ‰ ê¸€ì”¨ ìŠ¤íƒ€ì¼ ì ìš©
            });
        }

        /* ========================================
           5. ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ (í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰)
           ======================================== */
        // DOMContentLoaded: HTML ë¬¸ì„œ íŒŒì‹±ì´ ì™„ë£Œë˜ë©´ ì‹¤í–‰ (ì´ë¯¸ì§€ ë“± ë¦¬ì†ŒìŠ¤ ë¡œë“œ ì „)
        document.addEventListener('DOMContentLoaded', () => {
            
            /* ----- 5-1. ì´ˆê¸° í˜ì´ì§€ ë¡œë“œ ----- */
            // URLì˜ í•´ì‹œ(#koreanworship, #intro ë“±)ë¥¼ í™•ì¸í•˜ì—¬ ì´ˆê¸° í˜ì´ì§€ ê²°ì •
            // window.location.hash: í˜„ì¬ URLì˜ # ë’¤ ë¶€ë¶„ (ì˜ˆ: "#koreanworship")
            // substring(1): # ì œê±° (ì˜ˆ: "#koreanworship" â†’ "koreanworship")
            // || 'koreanworship': í•´ì‹œê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ìœ¼ë¡œ 'koreanworship' ì‚¬ìš©
            const hash = window.location.hash.substring(1) || 'koreanworship';
            // pageFiles ê°ì²´ì— í•´ë‹¹ í‚¤ê°€ ìˆëŠ”ì§€ í™•ì¸ (ìœ íš¨ì„± ê²€ì‚¬)
            const initialPage = pageFiles[hash] ? hash : 'koreanworship';
            // ì´ˆê¸° ì»¨í…ì¸  ë¡œë“œ (shouldScroll = falseë¡œ ìŠ¤í¬ë¡¤ ì•ˆ í•¨)
            loadContent(initialPage, false);
            setActiveMenu(initialPage);
            
            /* ----- 5-2. LNB(ì™¼ìª½ ë„¤ë¹„ê²Œì´ì…˜) ë©”ë‰´ í´ë¦­ ì´ë²¤íŠ¸ ----- */
            // data-page ì†ì„±ì„ ê°€ì§„ ëª¨ë“  LNB ë§í¬ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
            document.querySelectorAll('.lnb a[data-page]').forEach(link => {
                link.addEventListener('click', (e) => {
                    // ê¸°ë³¸ ë§í¬ ë™ì‘ ë°©ì§€ (í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ë°©ì§€)
                    e.preventDefault();
                    // í´ë¦­ëœ ë§í¬ì˜ data-page ì†ì„± ê°’ ê°€ì ¸ì˜¤ê¸°
                    const page = link.getAttribute('data-page');
                    // í•´ë‹¹ í˜ì´ì§€ ì»¨í…ì¸  ë¡œë“œ (shouldScroll ê¸°ë³¸ê°’ true ì‚¬ìš© - ìŠ¤í¬ë¡¤ë¨)
                    loadContent(page);
                    // ë©”ë‰´ í™œì„±í™” ìƒíƒœ ì—…ë°ì´íŠ¸
                    setActiveMenu(page);
                    // URL í•´ì‹œ ì—…ë°ì´íŠ¸ (ë¸Œë¼ìš°ì € íˆìŠ¤í† ë¦¬ì— ì¶”ê°€)
                    // ì˜ˆ: ami-church.html#intro
                    window.location.hash = page;
                });
            });
            
            /* ----- 5-3. í‘¸í„° ë©”ë‰´ í´ë¦­ ì´ë²¤íŠ¸ ----- */
            // data-page ì†ì„±ì„ ê°€ì§„ ëª¨ë“  í‘¸í„° ë§í¬ì— ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
            document.querySelectorAll('.footer-section a[data-page]').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();  // ê¸°ë³¸ ë™ì‘ ë°©ì§€
                    const page = link.getAttribute('data-page');
                    loadContent(page);   // ì»¨í…ì¸  ë¡œë“œ (ìŠ¤í¬ë¡¤ë¨)
                    setActiveMenu(page); // ë©”ë‰´ í™œì„±í™”
                    window.location.hash = page;  // URL ì—…ë°ì´íŠ¸
                    
                    // í‘¸í„°ëŠ” í˜ì´ì§€ í•˜ë‹¨ì— ìˆìœ¼ë¯€ë¡œ í˜ì´ì§€ ìµœìƒë‹¨ìœ¼ë¡œ ìŠ¤í¬ë¡¤
                    window.scrollTo({ 
                        top: 0,              // í˜ì´ì§€ ë§¨ ìœ„ë¡œ
                        behavior: 'smooth'   // ë¶€ë“œëŸ¬ìš´ ìŠ¤í¬ë¡¤
                    });
                });
            });
            
            /* ----- 5-4. ë¸Œë¼ìš°ì € ë’¤ë¡œê°€ê¸°/ì•ìœ¼ë¡œê°€ê¸° ë²„íŠ¼ ì§€ì› ----- */
            // hashchange: URLì˜ í•´ì‹œ(#)ê°€ ë³€ê²½ë  ë•Œ ë°œìƒí•˜ëŠ” ì´ë²¤íŠ¸
            // ë’¤ë¡œê°€ê¸°/ì•ìœ¼ë¡œê°€ê¸° ë²„íŠ¼ í´ë¦­ ì‹œì—ë„ ì‘ë™
            window.addEventListener('hashchange', () => {
                // ë³€ê²½ëœ í•´ì‹œì—ì„œ í˜ì´ì§€ ì´ë¦„ ì¶”ì¶œ
                const hash = window.location.hash.substring(1) || 'koreanworship';
                const page = pageFiles[hash] ? hash : 'koreanworship';
                // í•´ë‹¹ í˜ì´ì§€ë¡œ ì»¨í…ì¸  ë³€ê²½ (ìŠ¤í¬ë¡¤ë¨)
                loadContent(page);
                setActiveMenu(page);
            });
        });

    </script>
</body>
</html>